<%= form_with(model: @event, url: action_name == 'new' ? organizer_events_path : organizer_event_path(@event), local: true) do |form| %>
  <% if @event.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@event.errors.count, "error") %> prohibited this event from being saved:</h2>
      <ul>
        <% @event.errors.full_messages.each do |message| %>
          <li><%= message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <div class="field">
    <%= form.label :name, "Event Name" %>
    <%= form.text_field :name, required: true %>
  </div>

  <div class="field">
    <%= form.label :description, "Event Description" %>
    <%= form.text_area :description, required: true %>
  </div>

  <div class="field">
    <%= form.label :location, "Location" %>
    <%= form.text_field :location, required: true %>
  </div>

  <div class="field">
    <%= form.label :price, "Price" %>
    <%= form.number_field :price, step: 0.01, required: true %>
  </div>

  <div class="field">
    <%= form.label :capacity, "Capacity" %>
    <%= form.number_field :capacity, required: true %>
  </div>

  <div class="field">
    <%= form.label :starts_at, "Event Start Date and Time" %>
    <%= form.datetime_select :starts_at, required: true %>
  </div>

  <div class="field">
    <%= form.label :registration_start_date, "Registration Start Date" %>
    <%= form.datetime_select :registration_start_date, required: true %>
  </div>

  <div class="field">
    <%= form.label :registration_end_date, "Registration End Date" %>
    <%= form.datetime_select :registration_end_date, required: true %>
  </div>

  <div class="field">
    <%= form.label :category_id, "Category" %>
    <%= form.collection_select :category_id, Category.all, :id, :name, prompt: "Select a category", required: true %>
  </div>

  <div class="field">
    <%= form.label :image, "Event Image" %>
    <%= form.file_field :image %>
    <% if @event.image.attached? %>
      <div>
        <p>Current Image:</p>
        <%= image_tag url_for(@event.image), alt: @event.name, style: "max-width: 300px; height: auto;" %>
      </div>
    <% end %>
  </div>

  <div class="actions">
    <%= form.submit action_name == 'new' ? "Create Event" : "Update Event" %>
  </div>
<% end %>
